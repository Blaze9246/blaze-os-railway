<!DOCTYPE html>
<html>
<head>
    <title>Blaze OS Chat</title>
    <style>
        body { background: #0f0f1a; color: #fff; font-family: Arial; margin: 0; padding: 20px; }
        .chat-container { max-width: 600px; margin: 0 auto; background: #1a1a2e; border-radius: 12px; overflow: hidden; }
        .chat-header { background: #252542; padding: 15px; display: flex; align-items: center; gap: 10px; }
        .online { width: 10px; height: 10px; background: #22c55e; border-radius: 50%; }
        .messages { height: 400px; overflow-y: auto; padding: 15px; }
        .message { margin: 10px 0; padding: 10px 14px; border-radius: 12px; max-width: 80%; }
        .user { background: #3b82f6; margin-left: auto; }
        .bot { background: #ff6b35; }
        .input-area { display: flex; padding: 15px; background: #252542; gap: 10px; }
        input { flex: 1; padding: 12px; border: none; border-radius: 8px; background: #0f0f1a; color: #fff; }
        button { padding: 12px 24px; background: #ff6b35; border: none; border-radius: 8px; color: #fff; cursor: pointer; }
        .timestamp { font-size: 11px; color: #888; margin-top: 4px; }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="online"></div>
            <span>ðŸ’¬ Live Chat with Blaze (Telegram)</span>
        </div>
        <div class="messages" id="messages"></div>
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="Type a message..." onkeypress="if(event.key==='Enter')sendMessage()">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        const messagesDiv = document.getElementById('messages');
        const API_URL = 'https://blaze-os-railway-production.up.railway.app';
        
        // Load messages
        async function loadMessages() {
            try {
                const res = await fetch(`${API_URL}/api/messages`);
                const data = await res.json();
                
                messagesDiv.innerHTML = data.data.map(m => `
                    <div class="message ${m.sender === 'Zain' ? 'user' : 'bot'}">
                        <div>${m.sender}</div>
                        <div>${m.content}</div>
                        <div class="timestamp">${new Date(m.timestamp).toLocaleTimeString()}</div>
                    </div>
                `).join('');
                
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            } catch (e) {
                console.error('Load error:', e);
            }
        }
        
        // Send message
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text) return;
            
            try {
                await fetch(`${API_URL}/api/send-telegram`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text })
                });
                
                input.value = '';
                loadMessages();
            } catch (e) {
                alert('Failed to send: ' + e.message);
            }
        }
        
        // Auto-refresh
        loadMessages();
        setInterval(loadMessages, 3000);
    </script>
</body>
</html>
